import{h as q}from"./moment-BLMuvzoS.js";import{_ as G,d as P,b as s,w as t,a as l,c as d,g as u,r as m,m as p,f as c,t as _,i as H,n as R,D as B,o as a}from"./app-DFB2AWLk.js";import{r as K}from"./uploads-CnEkgyD_.js";import{U as O}from"./UserProfileDialog-Bus8cWkP.js";const Q={components:{UserProfileDialog:O},data(){return{drawer:!0,authStore:null,currentUser:null,userRoles:[],userPermissions:[],currentDate:q().format("Do MMMM YYYY"),currentYear:new Date().getFullYear(),unreadCount:0,unreadCountInterval:null,brandingLogo:null,siteName:null,profileDialogVisible:!1}},computed:{resolvedBrandingLogo(){return this.brandingLogo?this.resolveImageUrl(this.brandingLogo):null},resolvedUserAvatar(){return!this.currentUser||!this.currentUser.avatar?null:this.resolveImageUrl(this.currentUser.avatar)}},methods:{async loadUser(){var g;try{const e=localStorage.getItem("admin_token");if(!e){this.$router.push("/admin/login");return}const h=await this.$axios.get("/api/v1/auth/user",{headers:{Authorization:`Bearer ${e}`}});this.currentUser=h.data,this.userRoles=h.data.roles||[],this.authStore&&(this.authStore.user=h.data,this.authStore.token=e,this.authStore.isAuthenticated=!0,this.authStore.extractRolesAndPermissions(h.data)),this.userPermissions=[],this.userRoles&&this.userRoles.length>0&&this.userRoles.forEach(b=>{b.permissions&&b.permissions.length>0&&b.permissions.forEach(n=>{this.userPermissions.includes(n.slug)||this.userPermissions.push(n.slug)})})}catch(e){console.error("Error loading user:",e),((g=e.response)==null?void 0:g.status)===401&&(localStorage.removeItem("admin_token"),this.$router.push("/admin/login"))}},async loadBrandingSettings(){try{const g=localStorage.getItem("admin_token");if(!g)return;const e=await this.$axios.get("/api/v1/settings",{headers:{Authorization:`Bearer ${g}`}});e.data.general&&e.data.general.site_name&&e.data.general.site_name.value&&(this.siteName=e.data.general.site_name.value),e.data.branding&&e.data.branding.logo&&e.data.branding.logo.value&&(this.brandingLogo=e.data.branding.logo.value)}catch(g){console.error("Error loading branding settings:",g)}},async logout(){await B().logout(),this.currentUser=null,this.userRoles=[],this.userPermissions=[],this.$router.push("/admin/login")},hasPermission(g){return this.authStore&&(this.authStore.hasRole&&this.authStore.hasRole(["administrator"])||this.authStore.hasPermission&&this.authStore.hasPermission(g))?!0:!this.currentUser||!this.userPermissions||this.userPermissions.length===0?!1:this.userRoles&&this.userRoles.length>0&&this.userRoles.some(e=>e.slug==="administrator")?!0:this.userPermissions.includes(g)},canAccessLeads(){return!this.currentUser||!this.userPermissions||this.userPermissions.length===0?!1:this.hasPermission("view-leads")||this.hasPermission("manage-leads")||this.hasPermission("export-leads")},async loadUnreadCount(){if(this.canAccessLeads())try{const g=localStorage.getItem("admin_token");if(!g)return;const e=await this.$axios.get("/api/v1/leads/unread-count",{headers:{Authorization:`Bearer ${g}`}});this.unreadCount=e.data.unread||0}catch(g){console.error("Error loading unread count:",g)}},startUnreadCountPolling(){this.loadUnreadCount(),this.unreadCountInterval=setInterval(()=>{this.loadUnreadCount()},3e4)},stopUnreadCountPolling(){this.unreadCountInterval&&(clearInterval(this.unreadCountInterval),this.unreadCountInterval=null)},resolveImageUrl(g){return K(g)},showProfileDialog(){this.profileDialogVisible=!0}},mounted(){this.authStore=B(),localStorage.getItem("admin_token")?(this.loadUser().then(()=>{this.startUnreadCountPolling()}),this.loadBrandingSettings()):this.$router.push("/admin/login")},provide(){return{refreshUnreadCount:()=>{this.loadUnreadCount()}}},watch:{$route(){this.loadUnreadCount()}},beforeUnmount(){this.stopUnreadCountPolling()}},X={class:"d-flex align-center justify-space-between w-100"},Z={key:0,class:"unread-badge"},$={class:"pa-2"},ee={key:1,class:"notification-wrapper mr-3"},te={key:2,class:"d-flex align-center mr-4"},se={class:"footer-content"},ne={class:"footer-brand"},oe={class:"logo-wrapper"},ie=["src"],re={class:"brand-text"},ae={class:"powered-by-info"},le={class:"info-item mb-3"},de={class:"info-label"},ue={class:"info-item mb-3"},me={class:"info-label"},ce={class:"info-item mb-2"},ge={class:"info-label"},pe={class:"footer-info"},ve={class:"copyright-text"};function fe(g,e,h,b,n,o){const y=m("v-img"),A=m("v-avatar"),k=m("v-list-item-title"),U=m("v-tooltip"),r=m("v-list-item"),w=m("v-divider"),f=m("v-list-group"),C=m("v-list"),v=m("v-icon"),x=m("v-btn"),V=m("v-navigation-drawer"),I=m("v-app-bar-nav-icon"),L=m("v-chip"),S=m("v-spacer"),z=m("v-badge"),D=m("v-menu"),N=m("v-app-bar"),M=m("router-view"),Y=m("v-container"),E=m("v-main"),T=m("v-card-title"),J=m("v-card-text"),j=m("v-card"),F=m("v-footer"),W=m("UserProfileDialog");return a(),P("div",null,[s(V,{modelValue:n.drawer,"onUpdate:modelValue":e[1]||(e[1]=i=>n.drawer=i),class:"gradient_color",location:"left",permanent:"","hide-overlay":"",app:"",dark:""},{append:t(()=>[l("div",$,[s(x,{link:"",router:"",onClick:e[0]||(e[0]=i=>o.logout()),class:"logout-btn text-black",size:"small",block:""},{default:t(()=>[s(v,{left:""},{default:t(()=>[...e[6]||(e[6]=[c("mdi-logout",-1)])]),_:1}),e[7]||(e[7]=c("Logout ",-1))]),_:1})])]),default:t(()=>[e[8]||(e[8]=l("div",{class:"sidebar-shapes"},[l("div",{class:"shape shape-1"}),l("div",{class:"shape shape-2"}),l("div",{class:"shape shape-3"})],-1)),n.currentUser?(a(),d(r,{key:0,class:"user-profile-header"},{prepend:t(()=>[s(A,{size:"48",class:"mr-3"},{default:t(()=>[s(y,{src:o.resolvedBrandingLogo||"/assets/logo/default.png",alt:"Logo",cover:""},null,8,["src"])]),_:1})]),default:t(()=>[s(U,{location:"right",text:n.siteName||"Admin Panel"},{activator:t(({props:i})=>[s(k,p(i,{class:"text-body-2 font-weight-bold site-name-text"}),{default:t(()=>[c(_(n.siteName||"Admin Panel"),1)]),_:1},16)]),_:1},8,["text"])]),_:1})):u("",!0),s(w,{class:"my-0 divider-glow"}),n.currentUser&&n.userPermissions.length>0?(a(),d(C,{key:1,density:"compact",nav:""},{default:t(()=>[s(r,{"prepend-icon":"mdi-view-dashboard",title:"Dashboard",to:{name:"AdminDashboard"},value:"Dashboard",exact:""}),o.hasPermission("manage-products")||o.hasPermission("manage-services")||o.hasPermission("manage-about")||o.hasPermission("manage-announcements")||o.hasPermission("manage-blog")?(a(),d(f,{key:0,value:"content","prepend-icon":"mdi-file-document-edit","no-action":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Content Management"}),null,16)]),default:t(()=>[o.hasPermission("manage-products")?(a(),d(f,{key:0,value:"products","prepend-icon":"mdi-package-variant","no-action":"","sub-group":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Products"}),null,16)]),default:t(()=>[s(r,{"prepend-icon":"mdi-package-variant",title:"Products",to:{name:"AdminProducts"}}),s(r,{"prepend-icon":"mdi-star-half-full",title:"Reviews",to:{name:"AdminProductReviews"}}),s(r,{"prepend-icon":"mdi-folder",title:"Categories",to:{name:"AdminCategories"}}),s(r,{"prepend-icon":"mdi-tag",title:"Tags",to:{name:"AdminTags"}})]),_:1})):u("",!0),o.hasPermission("manage-services")?(a(),d(r,{key:1,"prepend-icon":"mdi-wrench",title:"Services",to:{name:"AdminServices"},value:"Services",exact:""})):u("",!0),o.hasPermission("manage-about")?(a(),d(r,{key:2,"prepend-icon":"mdi-information",title:"About Page",to:{name:"AdminAbout"},value:"About",exact:""})):u("",!0),o.hasPermission("manage-announcements")?(a(),d(r,{key:3,"prepend-icon":"mdi-bullhorn",title:"Announcements",to:{name:"AdminAnnouncements"},value:"Announcements",exact:""})):u("",!0),o.hasPermission("manage-blog")?(a(),d(f,{key:4,value:"blog","prepend-icon":"mdi-post","no-action":"","sub-group":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Blog"}),null,16)]),default:t(()=>[s(r,{"prepend-icon":"mdi-post",title:"Blog Posts",to:{name:"AdminBlog"}}),s(r,{"prepend-icon":"mdi-folder",title:"Categories",to:{name:"AdminBlogCategories"}})]),_:1})):u("",!0)]),_:1})):u("",!0),o.hasPermission("manage-careers")||o.hasPermission("manage-applications")?(a(),d(f,{key:1,value:"careers","prepend-icon":"mdi-briefcase","no-action":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Careers"}),null,16)]),default:t(()=>[o.hasPermission("manage-careers")?(a(),d(r,{key:0,"prepend-icon":"mdi-briefcase",title:"Careers",to:{name:"AdminCareers"}})):u("",!0),o.hasPermission("manage-applications")?(a(),d(r,{key:1,"prepend-icon":"mdi-file-document-edit",title:"Job Applications",to:{name:"AdminJobApplications"}})):u("",!0)]),_:1})):u("",!0),o.hasPermission("manage-users")||o.hasPermission("manage-roles")?(a(),d(f,{key:2,value:"users","prepend-icon":"mdi-account-group","no-action":""},{activator:t(({props:i})=>[s(r,p(i,{title:"User Management"}),null,16)]),default:t(()=>[o.hasPermission("manage-users")?(a(),d(r,{key:0,"prepend-icon":"mdi-account-group",title:"Users",to:{name:"AdminUsers"},value:"Users",exact:""})):u("",!0),o.hasPermission("manage-roles")?(a(),d(f,{key:1,value:"roles","prepend-icon":"mdi-shield-account","no-action":"","sub-group":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Roles & Permissions"}),null,16)]),default:t(()=>[s(r,{"prepend-icon":"mdi-shield-account",title:"Roles",to:{name:"AdminRoles"}}),s(r,{"prepend-icon":"mdi-key",title:"Permissions",to:{name:"AdminPermissions"}})]),_:1})):u("",!0)]),_:1})):u("",!0),o.canAccessLeads()||o.hasPermission("manage-newsletters")?(a(),d(f,{key:3,value:"communication","prepend-icon":"mdi-email","no-action":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Communication"}),null,16)]),default:t(()=>[o.canAccessLeads()?(a(),d(r,{key:0,"prepend-icon":"mdi-email",to:{name:"AdminLeads"},value:"Leads",exact:"",class:"leads-menu-item"},{title:t(()=>[l("div",X,[e[5]||(e[5]=l("span",null,"Leads",-1)),n.unreadCount>0?(a(),P("span",Z,_(n.unreadCount>99?"99+":n.unreadCount),1)):u("",!0)])]),_:1})):u("",!0),o.hasPermission("manage-newsletters")?(a(),d(r,{key:1,"prepend-icon":"mdi-email-newsletter",to:{name:"AdminNewsletters"},value:"Newsletters",exact:"",title:"Newsletters"})):u("",!0)]),_:1})):u("",!0),o.hasPermission("manage-settings")||o.hasPermission("view-login-logs")||o.hasPermission("view-visitor-logs")?(a(),d(f,{key:4,value:"system","prepend-icon":"mdi-cog","no-action":""},{activator:t(({props:i})=>[s(r,p(i,{title:"System & Administration"}),null,16)]),default:t(()=>[o.hasPermission("manage-settings")?(a(),d(r,{key:0,"prepend-icon":"mdi-cog",title:"Settings",to:{name:"AdminSettings"},value:"Settings",exact:""})):u("",!0),o.hasPermission("view-login-logs")||o.hasPermission("view-visitor-logs")?(a(),d(f,{key:1,value:"logs","prepend-icon":"mdi-file-document-multiple","no-action":"","sub-group":""},{activator:t(({props:i})=>[s(r,p(i,{title:"Logs"}),null,16)]),default:t(()=>[o.hasPermission("view-login-logs")?(a(),d(r,{key:0,"prepend-icon":"mdi-login",title:"Login Logs",to:{name:"AdminLoginLogs"}})):u("",!0),o.hasPermission("view-visitor-logs")?(a(),d(r,{key:1,"prepend-icon":"mdi-account-group",title:"Visitor Logs",to:{name:"AdminVisitorLogs"}})):u("",!0)]),_:1})):u("",!0)]),_:1})):u("",!0)]),_:1})):u("",!0)]),_:1},8,["modelValue"]),s(N,{app:"",flat:"",density:"compact",class:"gradient_color app-bar-modern"},{default:t(()=>[s(I,{onClick:e[2]||(e[2]=H(i=>n.drawer=!n.drawer,["stop"]))}),s(L,{class:"mx-2 date-chip"},{default:t(()=>[c(_(n.currentDate),1)]),_:1}),s(S),n.currentUser&&n.userRoles&&n.userRoles.some(i=>i.slug==="administrator")?(a(),d(L,{key:0,"prepend-icon":"mdi-shield-account"},{default:t(()=>[...e[9]||(e[9]=[c("Administrator",-1)])]),_:1})):u("",!0),s(S),n.currentUser&&o.canAccessLeads()?(a(),P("div",ee,[s(U,{location:"bottom",text:n.unreadCount>0?`${n.unreadCount} unread lead${n.unreadCount>1?"s":""}`:"View all leads"},{activator:t(({props:i})=>[s(x,p(i,{icon:"",variant:"text",to:{name:"AdminLeads"},class:["notification-btn",{"has-notifications":n.unreadCount>0}]}),{default:t(()=>[n.unreadCount>0?(a(),d(z,{key:0,content:n.unreadCount>99?"99+":n.unreadCount,color:"error",overlap:"",bordered:"",class:"notification-badge"},{default:t(()=>[s(v,{class:R({"notification-icon":!0,"has-pulse":n.unreadCount>0})},{default:t(()=>[...e[10]||(e[10]=[c(" mdi-bell ",-1)])]),_:1},8,["class"])]),_:1},8,["content"])):(a(),d(v,{key:1,class:R({"notification-icon":!0})},{default:t(()=>[...e[11]||(e[11]=[c(" mdi-bell-outline ",-1)])]),_:1}))]),_:1},16,["class"])]),_:1},8,["text"])])):u("",!0),n.currentUser?(a(),P("div",te,[s(D,{"open-on-hover":""},{activator:t(({props:i})=>[s(A,p(i,{size:"42",class:"fill-image mr-2",title:n.currentUser.name}),{default:t(()=>[n.currentUser.avatar?(a(),d(y,{key:0,cover:"",src:o.resolvedUserAvatar,alt:n.currentUser.name},null,8,["src","alt"])):(a(),d(y,{key:1,cover:"",src:"/assets/logo/default.png",alt:"image"}))]),_:1},16,["title"])]),default:t(()=>[s(C,null,{default:t(()=>[s(r,{onClick:o.showProfileDialog,style:{cursor:"pointer"}},{prepend:t(()=>[s(v,null,{default:t(()=>[...e[12]||(e[12]=[c("mdi-account",-1)])]),_:1})]),append:t(()=>[s(v,{size:"small"},{default:t(()=>[...e[13]||(e[13]=[c("mdi-chevron-right",-1)])]),_:1})]),default:t(()=>[s(k,null,{default:t(()=>[c(_(n.currentUser.name),1)]),_:1})]),_:1},8,["onClick"]),s(w,{class:"my-2"}),s(r,{link:"",router:"",onClick:e[3]||(e[3]=i=>o.logout())},{prepend:t(()=>[s(v,null,{default:t(()=>[...e[14]||(e[14]=[c("mdi-logout",-1)])]),_:1})]),default:t(()=>[s(k,null,{default:t(()=>[...e[15]||(e[15]=[c("Logout",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):u("",!0)]),_:1}),s(E,null,{default:t(()=>[s(Y,{fluid:""},{default:t(()=>[s(M)]),_:1})]),_:1}),s(F,{class:"footer-modern gradient_color rtl-footer",app:""},{default:t(()=>[l("div",se,[l("div",ne,[l("div",oe,[l("img",{src:o.resolvedBrandingLogo||"/assets/logo/default.png",alt:"MCT-IT",height:"24",class:"footer-logo"},null,8,ie)]),l("div",re,[s(D,{"open-on-hover":"",location:"top"},{activator:t(({props:i})=>[l("span",p({class:"brand-name powered-by-text"},i),[e[17]||(e[17]=c(" Powered By DigiLiftPro ",-1)),e[18]||(e[18]=l("a",{href:"https://digiliftpro.com",target:"_blank",style:{"text-decoration":"none",color:"inherit",opacity:"0.9"}},"https://digiliftpro.com",-1)),s(v,{size:"small",class:"ml-1"},{default:t(()=>[...e[16]||(e[16]=[c("mdi-information-outline",-1)])]),_:1})],16)]),default:t(()=>[s(j,{class:"powered-by-card","min-width":"280"},{default:t(()=>[s(T,{class:"text-h6 pb-2"},{default:t(()=>[s(v,{class:"mr-2"},{default:t(()=>[...e[19]||(e[19]=[c("mdi-code-tags",-1)])]),_:1}),e[20]||(e[20]=c(" Powered By DigiLiftPro ",-1))]),_:1}),s(w),s(J,{class:"pt-3"},{default:t(()=>[l("div",ae,[l("div",le,[l("div",de,[s(v,{size:"small",class:"mr-1"},{default:t(()=>[...e[21]||(e[21]=[c("mdi-web",-1)])]),_:1}),e[22]||(e[22]=c(" Website ",-1))]),e[23]||(e[23]=l("div",{class:"info-value"},[l("a",{href:"https://digiliftpro.com",target:"_blank",style:{color:"#6366f1","text-decoration":"none"}},"https://digiliftpro.com")],-1))]),l("div",ue,[l("div",me,[s(v,{size:"small",class:"mr-1"},{default:t(()=>[...e[24]||(e[24]=[c("mdi-account-circle",-1)])]),_:1}),e[25]||(e[25]=c(" Powered By ",-1))]),e[26]||(e[26]=l("div",{class:"info-value"},"DigiLiftPro",-1))]),l("div",ce,[l("div",ge,[s(v,{size:"small",class:"mr-1"},{default:t(()=>[...e[27]||(e[27]=[c("mdi-tag",-1)])]),_:1}),e[28]||(e[28]=c(" Version ",-1))]),e[29]||(e[29]=l("div",{class:"info-value"},"v1.0",-1))])])]),_:1})]),_:1})]),_:1})])]),e[31]||(e[31]=l("div",{class:"footer-divider"},null,-1)),l("div",pe,[e[30]||(e[30]=l("span",{class:"version-badge"},"v1.0",-1)),l("span",ve,"Â© "+_(n.currentYear)+" All Rights Reserved",1)])])]),_:1}),s(W,{modelValue:n.profileDialogVisible,"onUpdate:modelValue":e[4]||(e[4]=i=>n.profileDialogVisible=i),user:n.currentUser},null,8,["modelValue","user"])])}const ye=G(Q,[["render",fe],["__scopeId","data-v-01d7a9d3"]]);export{ye as default};
